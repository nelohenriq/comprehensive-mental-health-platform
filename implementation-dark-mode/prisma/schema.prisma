// Prisma schema for Comprehensive Mental Health Platform
// Privacy-first mental health platform with multi-provider AI integration

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String?
  password  String?
  image     String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  journalEntries JournalEntry[]
  moodEntries    MoodEntry[]
  aiConversations AIConversation[]
  thoughtRecords ThoughtRecord[]

  @@map("users")
}

model JournalEntry {
  id        String   @id @default(cuid())
  userId    String
  title     String?
  content   String   // Encrypted content
  mood      Int?     // Optional mood rating 1-5
  tags      String[] // Array of tags
  isPrivate Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("journal_entries")
}

model MoodEntry {
  id          String   @id @default(cuid())
  userId      String
  mood        Int      // 1-5 scale (1=Very Bad, 5=Very Good)
  note        String?  // Optional note
  activities  String[] // Activities that day
  sleepHours  Float?   // Hours of sleep
  stressLevel Int?     // 1-5 stress level
  createdAt   DateTime @default(now())

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("mood_entries")
}

model AIConversation {
  id        String            @id @default(cuid())
  userId    String
  provider  String            // AI provider (openai, anthropic, etc.)
  model     String            // Model used
  messages  Json              // Array of message objects
  context   String?           // Conversation context/tags
  createdAt DateTime          @default(now())
  updatedAt DateTime          @updatedAt

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("ai_conversations")
}

model ThoughtRecord {
  id                 String   @id @default(cuid())
  userId             String
  situation          String
  thoughts           String
  emotions           String
  behaviors          String
  alternativeThoughts String
  outcome            String
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("thought_records")
}
